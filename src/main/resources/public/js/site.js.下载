$(function () {
    LoadUserInfo();
});

function LoadUserInfo() {
    var prefixUrl = '//passport.cnblogs.com'
    $.ajax({
        url: prefixUrl + '/user/LoginInfo',
        dataType: 'jsonp',
        success: function (data) {
            $("#span_userinfo").html(data);
            var spacerUserId = parseInt($("#current_spaceId").html());
            if (spacerUserId > 0) {
                $.ajax({
                    url: prefixUrl + '/user/NewMsgCount',
                    data: 'spaceUserId=' + spacerUserId,
                    dataType: 'jsonp',
                    success: function (data) {
                        if (data) {
                            $("#msg_count").html('(' + data + ')').show();
                        }
                    }
                });
            }
        }
    });
}

function login() {
    location.href = "//passport.cnblogs.com/login.aspx?ReturnUrl=" + location.href;
    return false;
}
function register() {
    location.href = "//passport.cnblogs.com/register.aspx?ReturnUrl=" + location.href;
    return false;
}
function logout() {
    location.href = "//passport.cnblogs.com/logout.aspx?ReturnUrl=" + location.href;
    return false;
}